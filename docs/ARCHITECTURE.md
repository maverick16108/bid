# Архитектура проекта «Новосталь-М»

## 1. Общий подход

Проект реализуется как **монорепозиторий** с чётким разделением фронтенда и бэкенда.

Цели:
- независимое развитие frontend и backend,
- предсказуемая работа Gemini CLI в одном репозитории,
- масштабируемость (новые типы заявок, новые интеграции),
- корректная работа в окружении Debian + nginx.

---

## 2. Структура репозитория

/novostal-m/
 ├─ backend/        Laravel 11 (API)
 ├─ frontend/       Vue 3 SPA
 ├─ assets/         статические ресурсы
 │   └─ logo/
 ├─ docs/           документация
 │   ├─ TZ.md
 │   ├─ ARCHITECTURE.md
 │   ├─ INTEGRATION_1C.md
 │   ├─ BACKEND_GUIDELINES.md
 │   ├─ FRONTEND_GUIDELINES.md
 │   └─ PROMPTS_TASKS.md
 ├─ PROMPT_GEMINI.md
 └─ README.md

---

## 3. Окружение и маршрутизация

- Сервер: Debian
- nginx обслуживает домен `bid.prema.su`
- Frontend: SPA, nginx делает fallback на `index.html`
- Backend: API за reverse-proxy nginx, рекомендуемый префикс `/api`

---

## 4. Backend (Laravel)

Backend отвечает за:
- REST API для frontend,
- авторизацию по SMS (OTP),
- бизнес-логику заявок,
- интеграцию с 1С,
- контроль ролей и прав доступа.

Принципы:
- API-first
- строгая валидация
- Controllers → Services
- статусы и типы заявок фиксированы в коде
- БД: PostgreSQL

---

## 5. Frontend (Vue 3)

Frontend — SPA:
- публичная зона (ввод телефона, OTP)
- кабинет клиента
- админка

Принципы:
- Vue 3 + Composition API
- только через API
- никакой бизнес-логики 1С
- все ограничения проверяются backend

---

## 6. Интеграция с 1С

- 1С — источник истины
- HTTP + JSON
- логирование всех операций

---

## 7. Расширяемость

- новые типы заявок без переписывания ядра
- новые интеграции
- масштабирование

---

## 8. Ключевые ограничения

- нельзя редактировать статусы
- нельзя вводить арматуру вручную
- источник истины — 1С
- backend — единственная доверенная сторона